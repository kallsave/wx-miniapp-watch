/*!
 * wx-miniapp-watch.js v0.0.1
 * (c) 2019-2020 kallsave
 * Released under the MIT License.
 */
/*!
 * wx-miniapp-watch.js v0.0.1
 * (c) 2019-2020 kallsave
 * Released under the MIT License.
 */
var t,e;t=this,e=function(){"use strict";const t=Object.prototype.toString;function e(e){return t.call(e).slice(8,-1)}function n(t){return"Object"===e(t)}function s(t){return"Function"===e(t)}function i(t,e,n,s){Object.defineProperty(t,e,{value:n,enumerable:!!s,configurable:!0,writable:!0})}const o=Array.prototype,r=Object.create(o),a=["push","pop","shift","unshift","splice","sort","reverse"];a.forEach(t=>{const e=o[t];i(r,t,(function(){const n=[];Array.prototype.push.apply(n,arguments);const s=e.apply(this,n),i=this.__ob__;let o;switch(t){case"push":case"unshift":o=n;break;case"splice":o=n.slice(2)}return o&&i.observeArray(o),i.dep.notify(),s}))});let c=0;class l{constructor(){this.id=c++,this.subs=[]}addSub(t){this.subs.push(t)}notify(){this.subs.forEach(t=>{t.update()})}depend(){l.target.addDep(this)}}l.target=null;const h="__proto__"in{};function u(t,e,n,s){const i=Object.getOwnPropertyDescriptor(t,e);if(i&&!1===i.configurable)return;2===arguments.length&&(n=t[e]);const o=new l;let r=!s&&p(n);Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:()=>(l.target&&(o.depend(),r&&r.dep.depend()),n),set(t){t===n||t!=t&&n!=n||(n=t,r=!s&&p(t),o.notify())}})}class f{constructor(t){if(this.value=t,this.dep=new l,i(t,"__ob__",this),function(t){return"Array"===e(t)}(t)){if(h)t.__proto__=r;else for(let e=0;e<a.length;e++){const n=a[e];i(t,n,r[n])}this.observeArray(t)}else this.walk(t)}walk(t){const e=Object.keys(t);for(let n=0;n<e.length;n++){const s=e[n];u(t,s,t[s])}}observeArray(t){for(let e=0,n=t.length;e<n;e++)p(t[e])}}function p(t){if(t&&"object"==typeof t)return new f(t)}const d=new Set;function b(t){!function t(e,n){let s,i;const o=Array.isArray(e);if(o||null!==(r=e)&&"object"==typeof r){var r;if(e.__ob__){const t=e.__ob__.dep.id;if(n.has(t))return;n.add(t)}if(o)for(s=e.length;s--;)t(e[s],n);else for(i=Object.keys(e),s=i.length;s--;)t(e[i[s]],n)}}(t,d),d.clear()}class g{constructor(t,e,n,s){this.vm=t,this.cb=n,this.deep=s,this.depMap={},this.getter=this.parsePath(e),this.value=this.get()}parsePath(t){if(/[^\w.$]/.test(t))return;const e=t.split(".");return function(t){for(let n=0,s=e.length;n<s;n++){if(!t)return;t=t[e[n]]}return t}}get(){var t;t=this,l.target=t;const e=this.getter.call(this.vm,this.vm);return this.deep&&b(e),l.target=null,e}addDep(t){this.depMap.hasOwnProperty(t.id)||(t.addSub(this),this.depMap[t.id]=t)}update(){const t=this.get(),e=this.value;this.value=t,this.cb.call(this.vm,t,e)}}function y(t,e,n,s){return new g(t,e,(function(){const t=arguments;setTimeout(()=>{n(...t)},0)}),s)}function _(t,e){p(t);for(const i in e){const o=e[i];s(o)?y(t,i,o.bind(this)):n(o)&&s(o.handler)&&(o.immediate&&o.handler(t[i]),y(t,i,o.handler.bind(this),o.deep))}}function v(t,e,i,{watch:o,globalWatch:r}={watch:"watch",globalWatch:"globalWatch"}){let a;for(let n=0;n<e.length;n++){const s=e[n];if(t[s]){a=s;break}}if(a&&s(t[a])){const e=t[a];t[a]=function(){if(o){const e=t[o];n(e)&&_(this.data,e)}if(r){const e=t[r];if(n(e))try{_(getApp().globalData,e)}catch(t){console.log(t)}}return e.apply(this,arguments)}}return t}const w=["onLaunch"],m=App;var j={install(){this.installed||(this.installed=!0,App=function(t){t=v(t,w,0,{watch:"watch"}),m(t)})}};const A=["onLoad"],O=Page;var P={install(){this.installed||(this.installed=!0,Page=function(t){t=v(t,A),O(t)})}};const k=["created","attached","ready"],W=Component;var D={install(){this.installed||(this.installed=!0,Component=function(t){t=v(t,k),W(t)})}};const M={install(){this.installed||(this.installed=!0,j.install(),P.install(),D.install())},verson:"0.0.1"};return M.install(),M},"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).WxMiniappWatch=e();